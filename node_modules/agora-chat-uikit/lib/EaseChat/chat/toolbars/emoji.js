"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _react = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/styles");

var _emoji = require("../../../common/emoji");

var _core = require("@material-ui/core");

var _Popover = _interopRequireDefault(require("@material-ui/core/Popover"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

var useStyles = (0, _styles.makeStyles)(function () {
  return {
    emojiBox: {
      width: function width(props) {
        return props.width + 'px';
      },
      height: function height(props) {
        return props.height + 'px';
      },
      display: 'flex',
      flexWrap: 'wrap',
      padding: '16px'
    },
    myselfPopover: {
      '& .MuiPopover-paper': {
        borderRadius: '12px',
        backdropFilter: 'blur(12px)',
        background: 'rgba(255,255,255,.8)'
      }
    }
  };
});
var lineNum = 10;
var emojiWidth = 25;
var emojiPadding = 5;

function Emoji(_ref) {
  var anchorEl = _ref.anchorEl,
      onClose = _ref.onClose,
      onSelected = _ref.onSelected;
  var emojisNum = Object.values(_emoji.emoji.map).length;
  var rows = Math.ceil(emojisNum / lineNum);
  var width = (emojiWidth + 2 * emojiPadding) * lineNum;
  var height = (emojiWidth + 2 * emojiPadding) * rows;
  var classes = useStyles({
    width: width,
    height: height
  });

  function renderEmoji() {
    return Object.keys(_emoji.emoji.map).map(function (k) {
      var v = _emoji.emoji.map[k];
      return /*#__PURE__*/_react["default"].createElement(_core.Button, {
        style: {
          width: '35px',
          height: '35px',
          minHeight: '0',
          minWidth: '0'
        },
        key: k
      }, /*#__PURE__*/_react["default"].createElement("div", {
        style: {
          width: emojiWidth,
          height: emojiWidth,
          padding: emojiPadding
        }
      }, /*#__PURE__*/_react["default"].createElement("img", {
        src: require("../../../common/reactions/" + v)["default"],
        alt: k,
        width: emojiWidth,
        height: emojiWidth
      })));
    });
  }

  var handleEmojiClick = function handleEmojiClick(e) {
    var emoji = e.target.alt || e.target.children[0].alt;
    onSelected(emoji);
  };

  return /*#__PURE__*/_react["default"].createElement(_Popover["default"], {
    keepMounted: true,
    open: Boolean(anchorEl),
    onClose: onClose,
    anchorEl: anchorEl,
    style: {
      maxHeight: '500px'
    },
    anchorOrigin: {
      vertical: 'top',
      horizontal: 'left'
    },
    transformOrigin: {
      vertical: 'bottom',
      horizontal: 'left'
    },
    className: classes.myselfPopover
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: classes.emojiBox,
    onClick: handleEmojiClick
  }, renderEmoji()));
}

var _default = (0, _react.memo)(Emoji);

exports["default"] = _default;
module.exports = exports.default;